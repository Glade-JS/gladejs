var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function t(){throw new Error("Dynamic requires are not currently supported by rollup-plugin-commonjs")}function r(e,t){return e(t={exports:{}},t.exports),t.exports}var n=Array.prototype.slice;function i(e){return"function"==typeof e}function s(e){if(!i(e))throw TypeError("Invalid listener")}function o(e,t,r){switch(r.length){case 1:t.call(e);break;case 2:t.call(e,r[1]);break;case 3:t.call(e,r[1],r[2]);break;default:t.apply(e,n.call(r,1))}}function u(e,t,r,n){s(r);var o=e.$e||(e.$e={}),u=o[t];return u?i(u)?o[t]=n?[r,u]:[u,r]:n?u.unshift(r):u.push(r):o[t]=r,e}function l(){this.$e=this.$e||{}}l.EventEmitter=l,l.prototype={$e:null,emit:function(e){var t=arguments,r=this.$e;if(r){var s=r&&r[e];if(!s){if("error"===e){var u=t[1];if(!(u instanceof Error)){var l=u;(u=new Error("Error: "+l)).context=l}throw u}return!1}if(i(s))o(this,s,t);else for(var f=0,a=(s=n.call(s)).length;f<a;f++){var c=s[f];o(this,c,t)}return!0}},on:function(e,t){return u(this,e,t,!1)},prependListener:function(e,t){return u(this,e,t,!0)},once:function(e,t){return s(t),this.on(e,(function r(){this.removeListener(e,r),t&&(t.apply(this,arguments),t=null)})),this},removeListener:function(e,t){s(t);var r,n=this.$e;if(n&&(r=n[e]))if(i(r))r===t&&delete n[e];else for(var o=r.length-1;o>=0;o--)r[o]===t&&r.splice(o,1);return this},removeAllListeners:function(e){var t=this.$e;t&&delete t[e]},listenerCount:function(e){var t=this.$e,r=t&&t[e];return r?i(r)?1:r.length:0}};var f=l,a=r((function(e,t){function r(e){return!e.once}function n(e){this.$__target=e,this.$__listeners=[],this.$__subscribeTo=null}function i(e){this.$__target=e}function s(){this.$__subscribeToList=[]}n.prototype={$__remove:function(e,t){var r=this.$__target,n=this.$__listeners;this.$__listeners=n.filter((function(n){var i=n[0],s=n[1],o=n[2];if(t){if(o&&e(i,o))return r.removeListener(i,o),!1}else if(e(i,s))return r.removeListener(i,o||s),!1;return!0}));var i=this.$__subscribeTo;if(!this.$__listeners.length&&i){var s=this,o=i.$__subscribeToList;i.$__subscribeToList=o.filter((function(e){return e!==s}))}},on:function(e,t){return this.$__target.on(e,t),this.$__listeners.push([e,t]),this},once:function(e,t){var r=this,n=function(){r.$__remove((function(e,t){return n===t}),!0),t.apply(this,arguments)};return this.$__target.once(e,n),this.$__listeners.push([e,t,n]),this},removeListener:function(e,t){return"function"==typeof e&&(t=e,e=null),t&&e?this.$__remove((function(r,n){return e===r&&t===n})):t?this.$__remove((function(e,r){return t===r})):e&&this.removeAllListeners(e),this},removeAllListeners:function(e){var t=this.$__listeners,r=this.$__target;if(e)this.$__remove((function(t,r){return e===t}));else{for(var n=t.length-1;n>=0;n--){var i=t[n];r.removeListener(i[0],i[1])}this.$__listeners.length=0}return this}},i.prototype={on:function(e,t){return this.$__target.addEventListener(e,t),this},once:function(e,t){var r=this,n=function(){r.$__target.removeEventListener(e,n),t()};return this.$__target.addEventListener(e,n),this},removeListener:function(e,t){return this.$__target.removeEventListener(e,t),this}},s.prototype={subscribeTo:function(e,t){for(var s,o,u=!t||!1!==t.addDestroyListener,l=this.$__subscribeToList,f=0,a=l.length;f<a;f++){var c=l[f];if(c.$__target===e){s=c;break}}return s||(r(e)&&(o=new i(e)),s=new n(o||e),u&&!o&&s.once("destroy",(function(){s.removeAllListeners();for(var t=l.length-1;t>=0;t--)if(l[t].$__target===e){l.splice(t,1);break}})),s.$__subscribeTo=this,l.push(s)),s},removeAllListeners:function(e,t){var r,n=this.$__subscribeToList;if(e)for(r=n.length-1;r>=0;r--){var i=n[r];if(i.$__target===e){i.removeAllListeners(t),i.$__listeners.length||n.splice(r,1);break}}else{for(r=n.length-1;r>=0;r--)n[r].removeAllListeners();n.length=0}}},(t=e.exports=s).wrap=function(e){var t,s;return r(e)&&(t=new i(e)),s=new n(t||e),t||e.once("destroy",(function(){s.$__listeners.length=0})),s},t.createTracker=function(){return new s}})),c=(a.wrap,a.createTracker,"undefined"!=typeof window?window:e),h={NOOP:c.$W10NOOP=c.$W10NOOP||function(){}},_=Array.isArray;function v(e,t,r){for(var n=e,i=0;i<r;i++)n=n[t[i]];return n}function $(e){if("Date"===e.type)return new Date(e.value);if("NOOP"===e.type)return h.NOOP;throw new Error("Bad type")}var p=function(e){if(!e)return e;var t=e.$$;if(t){var r,n=e.o;if(t&&(r=t.length))for(var i=0;i<r;i++){var s,o=t[i],u=o.r;s=_(u)?v(n,u,u.length):$(u);var l=o.l,f=l.length-1;if(-1===f){n=e.o=s;break}v(n,l,f)[l[f]]=s}return t.length=0,null==n?null:n}return e};export{t as a,e as b,r as c,p as f,a as l,f as s};